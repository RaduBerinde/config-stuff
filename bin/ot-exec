#!/bin/bash
if [[ "$1" = -* || "$1" = "" ]]; then
  t=""
else
  t="$1"
  shift
fi
set -x

if [[ "$1" = -* || "$1" = "" ]]; then
  t="TestExecBuild"
else
  if [[ "$1" == *\/* ]]; then
    t="TestExecBuild/$1"
  else
    t="TestExecBuild//$1"
  fi
  shift
fi
set -x

cd -P .
cpulimit -l 600 -q -- make test PKG=./pkg/sql/opt/exec/execbuilder TESTS="$t" TESTFLAGS="$*" TESTTIMEOUT=30s |& tee /tmp/log
